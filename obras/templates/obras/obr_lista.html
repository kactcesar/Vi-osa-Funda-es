{% extends "vicosafundacoes/base.html" %}
{% load static %}
{% block script %}
<script src="{% static 'obras/js/obr_lista.js'%}"></script>
<script src="{% static 'categorias/js/pesq_cat_control.js' %}"></script> 
<script src="{% static 'fornecedor/js/pesq_forn_control.js' %}"></script> 
<script src="{% static 'assets/js/viewerjs/viewer.js' %}"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
{% endblock %}
{% block content %}
{% csrf_token %}
<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
    <!--begin::Subheader-->
    <div class="subheader py-2 py-lg-4 subheader-transparent" id="kt_subheader">
        <div class="container d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
            <!--begin::Info-->
            <div class="d-flex align-items-center flex-wrap mr-1">
                <!--begin::Page Heading-->
                <div class="d-flex align-items-baseline mr-5">
                    <!--begin::Page Title-->
                    <h5 class="text-dark font-weight-bold my-2 mr-5">Obra</h5>
                    <!--end::Page Title-->
                    <!--begin::Breadcrumb-->
                    <ul class="breadcrumb breadcrumb-transparent breadcrumb-dot font-weight-bold p-0 my-2 font-size-sm">
                        <li class="breadcrumb-item">
                            <a href="{% url 'vicosafundacoes:index' %}" class="text-muted">Viçosa Fundações</a>
                        </li>
                        <li class="breadcrumb-item">
                            <a href="" class="text-muted">Obra/Pedidos</a>
                        </li>
                    </ul>
                    <!--end::Breadcrumb-->
                </div>
            </div>
        </div>
    </div>
</div>
<div class="card card-custom gutter-b bg-white mt-10">
    <div class="card-body">
        <button onclick="abrir_modal_obr()" class="btn btn-light-primary btn-icon btn-circle">
            <i class="flaticon2-add-1"></i>
        </button>
        <table class="table table-head-custom" id="kt_obr">
            <thead>
                <tr>
                    <th class="datatable-row datatable-row-even">ID</th>
                    <th class="datatable-row datatable-row-even">Tipo de Obra</th>
                    <th class="datatable-row datatable-row-even">proprietário</th>
                    <th class="datatable-row datatable-row-even">Local</th>
                    <th class="datatable-row datatable-row-even">Data de início</th>
                    <th class="datatable-row datatable-row-even">Data de Termino</th>
                    <th class="datatable-row datatable-row-even">Status</th>
                    <th class="datatable-row datatable-row-even">Ações</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table> 
    </div>
</div>
<div class="modal fade" id="frm_obr_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-xl" role="document" >
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Obras</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i aria-hidden="true" class="ki ki-close"></i>
                </button>
            </div>
            <div class="modal-body" data-scroll="true" >
                <ul class="nav nav-tabs nav-tabs-line">
                    <li class="nav-item">
                        <a id="aba1" class="nav-link active" data-toggle="tab" href="#kt_tab_pane_1">Obras</a>
                    </li>
                    <li class="nav-item">
                        <a id="aba2"class="nav-link" data-toggle="tab" href="#kt_tab_pane_2">Pedidos</a>
                    </li> 
                </ul>
                <div class="tab-content mt-5" id="myTabContent">
                    <div class="tab-pane fade show active" id="kt_tab_pane_1" role="tabpanel" arial-labelledby="kt_tab_pane_1">   
                        <form method="post" id="frm_obr">
                            {% csrf_token %}
                            <div class="row">
                                <input type="hidden" id="obr_id" name="obr_id">
                            </div>
                            <div class="row">
                                <div class="form-group col-md-4">
                                    <label class="font-weight-bold" for="cat_obr">Tipo de Obra</label>
                                    <select class="form-control " id="cat_obr" name="cat_obr"></select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="font-weight-bold" for="obr_prop">Cliente</label>
                                    <input type="text" class="form-control" id="obr_prop" name="obr_prop" placeholder="Nome Proprietário" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="font-weight-bold" for="obr_loc">Localidade</label>
                                    <input type="text" class="form-control" id="obr_loc" name="obr_loc" placeholder="Localidade" required>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <label class="font-weight-bold" for="obr_dta_ini">Data de início</label>
                                    <input type="date" class="form-control" id="obr_dta_ini" name="obr_dta_ini"  required>
                                </div>
                            </div>   
                        </form>
                    </div> 
                    <div class="tab-pane fade "  id="kt_tab_pane_2" role="tabpanel" aria-labelledby="kt_tab_pane_2">
                        <button onclick="abrir_modal_ped()"  class="btn btn-light-primary btn-icon btn-circle" >
                            <i class="flaticon2-add-1"></i>
                        </button>
                        <table class="table table-head-custom table-responsive" id="kt_ped">
                            <thead>
                                <tr>
                                    <th class="datatable-row datatable-row-even">ID</th>
                                    <th class="datatable-row datatable-row-even">Data Do Pedido</th>
                                    <th class="datatable-row datatable-row-even">Solicitante</th>
                                    <th class="datatable-row datatable-row-even">Fornecedor</th>
                                    <th class="datatable-row datatable-row-even">Cnpj</th>
                                    <th class="datatable-row datatable-row-even">Ies</th>
                                    <th class="datatable-row datatable-row-even">N° Pedido</th>
                                    <th class="datatable-row datatable-row-even">Quantidade</th>
                                    <th class="datatable-row datatable-row-even">Uni. Medida</th>
                                    <th class="datatable-row datatable-row-even">Descrição</th>
                                    <th class="datatable-row datatable-row-even">Nota Fiscal</th>
                                    <th class="datatable-row datatable-row-even">Ações</th>
                            </thead>
                            <tbody>
                            </tbody>
                        </table> 
                    </div>                 
                    <div class="modal-footer">
                        <button type="button" class="btn btn-text-danger btn-hover-light-danger font-weight-bold" data-dismiss="modal">Sair</button>
                        <button onclick="obr_add()"type="button" id="obr_btn_salvar" class="btn btn-text-primary btn-hover-light-primary font-weight-bold">Salvar</button>
                    </div>
                </div>
            </div>                
        </div>
    </div>
</div>
<div class="modal fade" id="frm_ped_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Pedido</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i aria-hidden="true" class="ki ki-close"></i>
                </button>
            </div>
            <div class="modal-body" data-scroll="true">
                <form method="post" id="frm_ped">
                    {% csrf_token %}
                    <input type="hidden" id="ped_id" name="ped_id">
                    <div class="row">
                        <div class="form-group col-md-4">
                            <label class="font-weight-bold" for="ped_dta">Data Pedido</label>
                            <input type="date" class="form-control" id="ped_dta" name="ped_dta" required>
                        </div>
                        <div class="form-group col-md-4">
                            <label class="font-weight-bold" for="cat_pes">Solicitante</label>
                            <select class="form-control" id="cat_pes" name="cat_pes"></select>
                        </div>
                        <div class="form-group col-md-4">
                            <label class="font-weight-bold" for="forn">Fornecedor</label>
                            <select class="form-control" id="forn" name="forn"></select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-6">
                            <label class="font-weight-bold" for="ped_qtd">Quantidade</label>
                            <input type="number" class="form-control" id="ped_qtd" name="ped_qtd" placeholder="Quantidade" required>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="font-weight-bold" for="cat_uni">Un. medida</label>
                            <select class="form-control" id="cat_uni" name="cat_uni"></select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label for="ped_desc">Descrição</label>
                            <textarea class="form-control" id="ped_desc" name="ped_desc" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-form-label col-lg-3 col-sm-12 text-lg-right">Nota</label>
                        <div class="col-lg-4 col-md-9 col-sm-12">
                            <div class="dropzone dropzone-default dropzone-success" id="ped_arq_images">
                                <i class="far fa-file-pdf icon-6x"></i>
                                <div class="dz-message needsclick">
                                    <h3 class="dropzone-msg-title">Arraste os arquivos aqui ou clique para fazer upload</h3>
                                    <span class="dropzone-msg-desc">Poderão ser anexados qualquer tipo de arquivo: imagem, PDF, CSV, etc. </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-text-danger btn-hover-light-danger font-weight-bold" data-dismiss="modal">Sair</button>
                        <button onclick="ped_add()" type="button" id="ped_btn_salvar" class="btn btn-text-success btn-hover-light-success font-weight-bold">Salvar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %} 


